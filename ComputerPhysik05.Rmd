---
title: 'Übung 05: Spektrum einer Klaviersaite'
author: "Tobias Blesgen und Leonardo Thome"
date: "27.06.2021"
output:
  pdf_document: default
  html_document:
    df_print: paged
header-includes: 
 - \usepackage{amssymb}
 - \usepackage{amsmath}
 - \usepackage[ngerman]{babel}
 - \bibliographystyle{unsrtnat}
---

[//]: # Ausführbefehl im allgemeinen: ``render("ComputerPhysik05.Rmd")``

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Schlägt man eine Klaviersaite an, so verhält sie sich nach:

\begin{equation} \label{gl1}
      \frac{\partial^2\psi(x,t)}{\partial t^2} = c^2 \frac{\partial^2\psi(x,t)}{\partial x^2} - \frac{\gamma}{l}|\frac{\partial \psi (x,t)}{\partial t}|(\frac{\partial \psi (x,t)}{\partial t}).
\end{equation}

Wir wollen dieses Verhalten im Folgenden numerisch untersuchen. Hierzu schreiben wir Gleichung \ref{gl1} um zu:

\begin{equation}
  \frac{\psi_{i+1, j} - 2\psi_{i,j} + \psi_{i-1,j}}{\Delta t^2} = c^2 \frac{\psi_{i,j+1} - 2\psi_{i,j} + \psi_{i,j-1}}{\Delta x^2} - \frac{\gamma}{l} |\frac{\psi_{i,j}-\psi_{i-1,j}}{\Delta t}| \frac{\psi_{i,j}-\psi_{i-1,j}}{\Delta t}
\end{equation}

Dies lässt sich umschreiben zu:

\begin{equation}
  \psi_{i+1,j} = \frac{\Delta t^2 c^2}{\Delta x^2} (\psi_{i,j+1} - 2\psi_{i,j} + \psi_{i,j-1}) + 2\psi_{i,j} - \psi_{i-1,j} - \frac{\gamma}{l} |\psi_{i,j}-\psi_{i-1,j}|(\psi_{i,j}-\psi_{i-1,j})
\end{equation}

# Runge-Kutta 2 Verfahren

merische Stabilität (soweit das System selbst stabil ist) und weist mit einem Verfahrensfehler von $\mathcal{O}(h^2)$ einen kleineren Fehler als das Eulerverfahren auf für kleine Schrittweiten h.

# Implementation des DGS nach dem Runge-Kutta 2 Verfahren

```{Rcpp}
#include<Rcpp.h>
#include<vector>
#include<algorithm>
#include<math.h>  

using namespace Rcpp;


//[[Rcpp::export]]
std::vector<double> klaviersaite(const double l, const double roh, 
                                              const double force, const double
                                              gamma, const int xSchritte,
                                              const double dt, const int 
                                              zeitSchritte){
  // Array der Werte zur späteren Ausgabe
    std::vector<std::vector<double>> zeitvektor(zeitSchritte);
  // Quelltext
    // Startwerte
    std::vector<double> startwerte(xSchritte);
    for (int i = 0; i<xSchritte; i++){
      startwerte[i] = 0.0;
    }
    startwerte[(int)(0.26*(xSchritte-1))] = 0.01;
    
    zeitvektor[0] = startwerte;
    zeitvektor[1] = startwerte;
    
    // Funktionsdurchläufe
    double dx = l/(xSchritte - 1);
    double c = 299792458;
    double C = dt*dt*c*c/(dx*dx);
    
    for (int i = 2; i<zeitSchritte; i++){
      std::vector<double> tVektor(xSchritte);
      // Randbedingungen
      tVektor[0] = 0;
      tVektor[xSchritte-1] = 0;
      for (int j = 1; j<xSchritte-1; j++){
        tVektor[j] = C*(zeitvektor[i-1][j+1] - 2*zeitvektor[i-1][j] + 
          zeitvektor[i-1][j-1]) + 2*zeitvektor[i-1][j] - zeitvektor[i-2][j] - 
          gamma/l * fabs(zeitvektor[i-1][j]-zeitvektor[i-2][j]) *
          (zeitvektor[i-1][j]-zeitvektor[i-2][j]);
      }
      zeitvektor[i] = tVektor;
    }
    
  // Rückgabe für eine grafische Wiedergabe
    return zeitvektor[9];
}

```

```{r, echo=FALSE, fig.cap="\\label{fig:Zeitentwicklung} k)", fig.width=7,fig.height=4}
l = 0.4
roh = 0.006
force = 743.4
gamma = 1/3
xSchritte = 100
dt = 0.01
zeitSchritte = 10
datenMatrix = klaviersaite(l, roh, force, gamma, xSchritte, dt, zeitSchritte)
plot(0:99,datenMatrix,"l")

```

# Fazit
Wir erhalten bei den meisten Werten ein nicht chaotisches Verhalten zwischen $\theta$ und $\dot \theta$, können jedoch auch chaotische Situationen konstruieren. Dies ist im physikalischen Sinne auch nachvollziehbar, da die Eigenrotation des Mondes durch geschickt gewählte Bahnen stark von der Radiusvariation beeinflusst werden kann.

Wir können aber sehen, dass dieses Verhalten nicht immer eintritt und wir im Allgemeinen ein strukturiertes Verhalten vorfinden.


\begin{thebibliography}{99}

\bibitem{kepler}
Keplersche Gesetze \url{https://de.wikipedia.org/wiki/Keplersche_Gesetze}, Stand 22.06.2021

\end{thebibliography}
